% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualization.R
\name{euiss_spikemap}
\alias{euiss_spikemap}
\title{Transform Simple Features object into spike coordinates for spike maps}
\usage{
euiss_spikemap(
  data,
  val,
  fact = 1e+05,
  spread = NULL,
  of_largest_polygon = TRUE,
  drop_geom = TRUE,
  polygon_format = TRUE,
  min_value = NULL,
  max_spikes = NULL
)
}
\arguments{
\item{data}{A Simple Features (sf) object with polygon or point geometries.}

\item{val}{The variable name representing the height/value of spikes (unquoted).}

\item{fact}{Scaling factor to control the height of spikes relative to the map.}

\item{spread}{The width factor for spike base. If NULL, defaults to fact/50.}

\item{of_largest_polygon}{Logical. For multipolygons, use centroid of largest polygon? Default TRUE.}

\item{drop_geom}{Logical. Should the geometry column be dropped from output? Default TRUE.}

\item{polygon_format}{Logical. Return data formatted for geom_polygon()? Default TRUE.}

\item{min_value}{Minimum value threshold - spikes below this won't be drawn.}

\item{max_spikes}{Maximum number of spikes to draw (for performance).}
}
\value{
A data frame with coordinates for creating spike visualizations.
        If polygon_format=TRUE, returns data suitable for geom_polygon().
        If FALSE, returns line format for backward compatibility.
}
\description{
This function transforms a Simple Features (sf) object into coordinate data for
creating spike visualizations. Spikes are triangular representations where 
height corresponds to data values, useful for showing quantitative data on maps.
}
\details{
The function creates triangular spikes where:
\itemize{
  \item Base width is controlled by \code{spread}
  \item Height is proportional to \code{val * fact}
  \item Base is positioned at polygon centroid
  \item Peak extends upward from centroid
}

For best results, experiment with the \code{fact} parameter to get appropriate
spike heights relative to your map extent. Typical values range from 0.0001 to 100000
depending on your coordinate system and data range.
}
\examples{
\dontrun{
# Load country data
countries <- euiss_gisco(res = "20")

# Add some sample data
countries$population <- runif(nrow(countries), 1e6, 1e8)

# Create spike data
spike_data <- euiss_spikemap(
  countries, 
  val = population, 
  fact = 100000
)

# Plot with ggplot2
library(ggplot2)
ggplot() +
  geom_sf(data = countries, fill = "lightgray") +
  geom_polygon(data = spike_data, aes(x = x, y = y, group = spike_id, fill = population)) +
  theme_void()

# Custom spike parameters
spike_data_custom <- euiss_spikemap(
  countries,
  val = population,
  fact = 50000,
  spread = 20000,
  min_value = 5e6
)
}

}
